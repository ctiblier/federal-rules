---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const civilEntries = await getCollection('civil');
const criminalEntries = await getCollection('criminal');

const civilCurrent = civilEntries.filter(e => e.id.endsWith('/current.md'));
const criminalCurrent = criminalEntries.filter(e => e.id.endsWith('/current.md'));

// Get last amended date from any current entry
const civilLastAmended = civilCurrent[0]?.data.last_amended ?? '';
const criminalLastAmended = criminalCurrent[0]?.data.last_amended ?? '';
---

<BaseLayout
  title="Home"
  description="Federal Rules of Civil and Criminal Procedure — professional reference for attorneys and law students."
  noSidebar={true}
>
  <div style="max-width: 680px; margin: 0 auto; padding: 5rem 1.5rem 6rem;">
    <!-- Hero -->
    <header style="margin-bottom: 3.5rem;">
      <h1 style="font-family: 'Lora', Georgia, serif; font-size: clamp(1.75rem, 4vw, 2.5rem); font-weight: 700; color: #1c1c1e; line-height: 1.2; margin-bottom: 1rem;">
        Federal Rules, finally readable.
      </h1>
      <p style="font-family: 'Lora', Georgia, serif; font-size: 1.0625rem; color: #6b7280; line-height: 1.7; max-width: 520px;">
        The complete Federal Rules of Procedure — civil, criminal, and more — with search, version history, and one-click citation.
      </p>
    </header>

    <!-- Ruleset cards -->
    <section aria-label="Available rulesets" style="margin-bottom: 4rem;">
      <h2 style="font-family: system-ui, sans-serif; font-size: 0.6875rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: #6b7280; margin-bottom: 0.875rem;">
        Rulesets
      </h2>
      <div style="display: flex; flex-direction: column; gap: 0.75rem;">

        <!-- Civil Procedure -->
        <a
          href="/civil/"
          class="ruleset-card"
          style="display: block; padding: 1.25rem 1.5rem; border-radius: 0.5rem; border: 1px solid rgba(28,28,30,0.15); background-color: white; text-decoration: none; transition: border-color 0.15s, box-shadow 0.15s;"
        >
          <div style="display: flex; align-items: flex-start; justify-content: space-between; gap: 1rem;">
            <div>
              <p style="font-family: system-ui, sans-serif; font-size: 0.6875rem; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase; color: #1a2744; margin-bottom: 0.375rem;">
                Civil Procedure
              </p>
              <p style="font-family: 'Lora', Georgia, serif; font-size: 1rem; font-weight: 700; color: #1c1c1e; margin-bottom: 0.375rem; line-height: 1.3;">
                Federal Rules of Civil Procedure
              </p>
              <p style="font-family: system-ui, sans-serif; font-size: 0.8125rem; color: #6b7280;">
                Last amended {civilLastAmended}
              </p>
            </div>
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" aria-hidden="true" style="color: #1a2744; flex-shrink: 0; margin-top: 0.25rem;">
              <path d="M3 9h12M10 4l5 5-5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </a>

        <!-- Criminal Procedure -->
        <a
          href="/criminal/"
          class="ruleset-card"
          style="display: block; padding: 1.25rem 1.5rem; border-radius: 0.5rem; border: 1px solid rgba(28,28,30,0.15); background-color: white; text-decoration: none; transition: border-color 0.15s, box-shadow 0.15s;"
        >
          <div style="display: flex; align-items: flex-start; justify-content: space-between; gap: 1rem;">
            <div>
              <p style="font-family: system-ui, sans-serif; font-size: 0.6875rem; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase; color: #1a2744; margin-bottom: 0.375rem;">
                Criminal Procedure
              </p>
              <p style="font-family: 'Lora', Georgia, serif; font-size: 1rem; font-weight: 700; color: #1c1c1e; margin-bottom: 0.375rem; line-height: 1.3;">
                Federal Rules of Criminal Procedure
              </p>
              <p style="font-family: system-ui, sans-serif; font-size: 0.8125rem; color: #6b7280;">
                Last amended {criminalLastAmended}
              </p>
            </div>
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" aria-hidden="true" style="color: #1a2744; flex-shrink: 0; margin-top: 0.25rem;">
              <path d="M3 9h12M10 4l5 5-5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </a>

        <!-- Evidence (coming soon) -->
        <div
          style="display: block; padding: 1.25rem 1.5rem; border-radius: 0.5rem; border: 1px solid rgba(28,28,30,0.08); background-color: transparent;"
          aria-disabled="true"
        >
          <div style="display: flex; align-items: flex-start; justify-content: space-between; gap: 1rem;">
            <div>
              <p style="font-family: system-ui, sans-serif; font-size: 0.6875rem; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase; color: #9ca3af; margin-bottom: 0.375rem;">
                Evidence
              </p>
              <p style="font-family: 'Lora', Georgia, serif; font-size: 1rem; font-weight: 700; color: #9ca3af; line-height: 1.3;">
                Federal Rules of Evidence
              </p>
            </div>
            <span style="font-family: system-ui, sans-serif; font-size: 0.6875rem; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase; color: #9ca3af; flex-shrink: 0; margin-top: 0.25rem;">
              Coming soon
            </span>
          </div>
        </div>

      </div>
    </section>
  </div>
</BaseLayout>

<style>
  .ruleset-card:hover {
    border-color: rgba(28,28,30,0.3);
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  }
</style>
