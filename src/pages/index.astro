---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout
  title="Home"
  description="The complete Federal Rules of Civil Procedure. Professional reference for practicing attorneys and law students."
>
  <div class="max-w-2xl mx-auto px-6 py-16" style="padding-top: 4rem; padding-bottom: 6rem;">
    <header style="margin-bottom: 3rem;">
      <h1 style="font-family: 'Lora', Georgia, serif; font-size: 2.25rem; font-weight: 700; color: #1c1c1e; line-height: 1.2; margin-bottom: 1rem;">
        Federal Rules of<br />Civil Procedure
      </h1>
      <p style="font-family: 'Lora', Georgia, serif; font-size: 1.0625rem; color: #6b7280; line-height: 1.6;">
        Complete, current text of all Federal Rules of Civil Procedure including Supplemental Rules.
      </p>
    </header>

    <!-- Pagefind search -->
    <section id="search" aria-label="Search the rules" style="margin-bottom: 3rem;">
      <div id="pagefind-search"></div>
    </section>

    <!-- Quick links -->
    <nav aria-label="Quick links" style="display: flex; flex-wrap: wrap; gap: 0.75rem;">
      <a
        href="/rules/"
        class="home-browse-link"
        style="display: inline-flex; align-items: center; gap: 0.5rem; background-color: #1a2744; color: white; padding: 0.625rem 1.25rem; border-radius: 0.375rem; font-family: system-ui, sans-serif; font-size: 0.875rem; font-weight: 500; text-decoration: none; transition: opacity 0.15s;"
      >
        Browse all rules
        <svg width="13" height="13" viewBox="0 0 13 13" fill="none" aria-hidden="true">
          <path d="M2 6.5h9M7 2l4.5 4.5L7 11" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </a>
      <a
        href="/rules/1/"
        style="display: inline-flex; align-items: center; padding: 0.625rem 1.25rem; border-radius: 0.375rem; border: 1px solid rgba(28,28,30,0.2); color: #1c1c1e; font-family: system-ui, sans-serif; font-size: 0.875rem; font-weight: 500; text-decoration: none; transition: border-color 0.15s;"
      >
        Start with Rule 1
      </a>
      <a
        href="/rules/26/"
        style="display: inline-flex; align-items: center; padding: 0.625rem 1.25rem; border-radius: 0.375rem; border: 1px solid rgba(28,28,30,0.2); color: #1c1c1e; font-family: system-ui, sans-serif; font-size: 0.875rem; font-weight: 500; text-decoration: none; transition: border-color 0.15s;"
      >
        Rule 26 — Disclosures
      </a>
    </nav>
  </div>
</BaseLayout>

<style>
  .home-browse-link:hover { opacity: 0.85; }
</style>

<script>
  const searchEl = document.getElementById('pagefind-search');
  if (searchEl) {
    const observer = new IntersectionObserver((entries) => {
      if (!entries[0].isIntersecting) return;
      observer.disconnect();

      // Load Pagefind CSS
      const link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = '/pagefind/pagefind-ui.css';
      document.head.appendChild(link);

      // Load Pagefind UI via script tag — pagefind-ui.js sets window.PagefindUI
      const script = document.createElement('script');
      script.src = '/pagefind/pagefind-ui.js';
      script.onload = () => {
        new (window as any).PagefindUI({
          element: '#pagefind-search',
          showSubResults: true,
          resetStyles: false,
        });
      };
      script.onerror = () => {
        if (searchEl) {
          searchEl.innerHTML = '<p style="color: #6b7280; font-size: 0.875rem; font-family: system-ui, sans-serif;">Search available after running <code>npm run build</code>.</p>';
        }
      };
      document.head.appendChild(script);
    });
    observer.observe(searchEl);
  }
</script>
